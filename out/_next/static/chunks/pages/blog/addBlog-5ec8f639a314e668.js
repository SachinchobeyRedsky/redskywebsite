(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6239],{1744:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/addBlog",function(){return n(95592)}])},82583:function(e,t,n){"use strict";n.d(t,{I:function(){return c},db:function(){return l}});var r=n(83977),o=n(39828),a=n(91259),i=n(77004),u=(0,r.ZF)({apiKey:"AIzaSyBJA3OU9j2hD3eCcuBK1ufK9KIs7xkijqM",authDomain:"redsky-web.firebaseapp.com",projectId:"redsky-web",storageBucket:"redsky-web.appspot.com",messagingSenderId:"503303012281",appId:"1:503303012281:web:fbadea13c15e03b9c48068",measurementId:"G-75QR2Q2EBR"}),l=(0,o.ad)(u),c=(0,a.v0)(u);(0,i.$C)(u)},95592:function(e,t,n){"use strict";n.r(t);var r=n(47568),o=n(82670),a=n(26042),i=n(69396),u=n(29815),l=n(70655),c=n(85893),s=n(67294),d=n(5152),f=n.n(d),h=n(97375),b=n(43238),p=n(68527),g=n(11391),v=n(33441),m=n(70553),x=(n(99624),n(91259)),w=n(11163),k=n(39828),y=n(82583),j=n(86650),_=(n(5526),f()((function(){return n.e(4687).then(n.bind(n,94687))}),{loadableGenerated:{webpack:function(){return[94687]}},ssr:!1})),S=f()((function(){return n.e(134).then(n.bind(n,87503))}),{loadableGenerated:{webpack:function(){return[87503]}}}),C=f()((function(){return Promise.all([n.e(5675),n.e(7311),n.e(9876),n.e(2199),n.e(180),n.e(5193)]).then(n.bind(n,80180))}),{loadableGenerated:{webpack:function(){return[80180]}}}),E=f()((function(){return Promise.all([n.e(5675),n.e(3513),n.e(6893),n.e(2141),n.e(2919)]).then(n.bind(n,92141))}),{loadableGenerated:{webpack:function(){return[92141]}}}),Z=f()((function(){return Promise.all([n.e(4617),n.e(7311),n.e(9839),n.e(8446),n.e(973)]).then(n.bind(n,68446))}),{loadableGenerated:{webpack:function(){return[68446]}}});f()((function(){return n.e(3993).then(n.bind(n,93993))}),{loadableGenerated:{webpack:function(){return[93993]}}});t.default=function(){var e=(0,k.JU)(y.db,"blogSettings","blogs-counter"),t=(0,k.JU)(y.db,"blogSettings","drafts-counter"),d=(0,h.qY)(),f=d.isOpen,B=d.onOpen,A=d.onClose,O=(0,b.pm)(),T=(0,s.useRef)(null),F=(0,x.v0)(),J=(0,w.useRouter)(),P=null===J||void 0===J?void 0:J.query,U=(0,s.useState)(!1),D=(U[0],U[1]),I=(0,s.useState)(!1),N=I[0],Q=I[1],z=(0,s.useState)(""),q=z[0],G=z[1],L=(0,s.useState)([]),W=L[0],R=L[1],K=(0,s.useState)(""),Y=K[0],H=K[1],X=(0,s.useState)(""),M=X[0],V=X[1],$=(0,s.useState)(""),ee=$[0],te=$[1],ne=(0,s.useState)(!1),re=ne[0],oe=ne[1],ae=(0,s.useState)(""),ie=ae[0],ue=ae[1],le=(0,s.useState)(!1),ce=le[0],se=le[1],de=(0,s.useState)([]),fe=de[0],he=de[1];(0,s.useEffect)((function(){G(P.newObj),V(P.title),ue(P.category)}),[]);var be=function(){var e=(0,r.Z)((function(){return(0,l.__generator)(this,(function(e){return[2,new Promise(function(){var e=(0,r.Z)((function(e,t){var r,o,u;return(0,l.__generator)(this,(function(t){switch(t.label){case 0:return[4,n(71167).Quill];case 1:return r=t.sent(),[4,n.e(3721).then(n.bind(n,3721))];case 2:return o=t.sent().default,(u=r.import("formats/image")).DEFAULTS=(0,i.Z)((0,a.Z)({},u.DEFAULTS),{align:"center"}),e({Quill:r,BlotFormatter:o}),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()).then((function(e){var t=e.Quill,n=e.BlotFormatter;t.register("modules/blotFormatter",n),console.log("bllofggggg>>>>",t.register("modules/blotFormatter",n))})).then((function(e){G(e),Q(!0)}))]}))}));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){be()}),[]);var pe=function(e){return e?[e.index,e.index+e.length].join(","):"none"};(0,s.useEffect)((function(){F.onAuthStateChanged(function(){var e=(0,r.Z)((function(e){var t,n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return e?(t=(0,k.JU)(y.db,"authUsers",e.uid),[4,(0,k.QT)(t)]):[3,2];case 1:(n=r.sent()).exists()&&n.data().isBlocked?te(null):te(e),r.label=2;case 2:return[2]}}))}));return function(t){return e.apply(this,arguments)}}())}),[]),(0,s.useEffect)((function(){var e=(0,k.IO)((0,k.hJ)(y.db,"categories"),(0,k.Xo)("createdAt","desc"));return(0,k.cf)(e,(function(e){var t=e.docs.map((function(e){return(0,i.Z)((0,a.Z)({},e.data()),{id:e.id})}));he(t)}))}),[]);var ge=function(){var t=(0,r.Z)((function(t){var n,r,o,u,c,s,d,f,h,b,p,g,v;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:t.preventDefault(),l.label=1;case 1:for(l.trys.push([1,4,,5]),n=M.toLowerCase(),r=[],o=n.split(" "),u=1;u<M.length+1;u++)r.push(M.substring(0,u));for(c=0;c<o.length;c++)for(s=1;s<o[c].length+1;s++)r.push(o[c].substring(0,s));return[4,(0,k.QT)(e)];case 2:return d=l.sent(),f=(0,k.hJ)(y.db,"categories"),h=(0,k.JU)(f,ie),[4,(0,k.QT)(h)];case 3:return b=l.sent(),p=b.data().count,g={title:M,titleAsArray:r,newObj:q,userEmail:ee.email,userName:ee.displayName,userUid:ee.uid,category:b.data().key,createdAt:(0,k.Bt)()},Promise.all([(0,k.ET)((0,k.hJ)(y.db,"blogData"),(0,a.Z)({},g)),(0,k.pl)(e,(0,i.Z)((0,a.Z)({},d.data()),{all:{count:d.data().all.count+1,name:"All"}})),(0,k.pl)(h,(0,i.Z)((0,a.Z)({},b.data()),{count:p+1}))]).then((function(){P.id&&xe(P.id),J.push("/blog")})).catch((function(e){console.log(e)})),[3,5];case 4:return v=l.sent(),console.error("Error adding document: ",v),[3,5];case 5:return[2]}}))}));return function(e){return t.apply(this,arguments)}}(),ve=function(e){ce&&(me(),se(!1))};(0,s.useEffect)((function(){return J.events.on("routeChangeStart",ve),function(){J.events.off("routeChangeStart",ve)}}),[J.events,q,ie,M]),(0,s.useEffect)((function(){var e=setTimeout((function(){D(!0),me()}),1e4);return function(){clearTimeout(e)}}),[q,ie,M]);var me=function(){var e=(0,r.Z)((function(){var e,t,n,r,u,c,s,d,f,h,b;return(0,l.__generator)(this,(function(l){switch(l.label){case 0:for(l.trys.push([0,8,,9]),e=M.toLowerCase(),t=[],n=e.split(" "),r=1;r<M.length+1;r++)t.push(M.substring(0,r));for(u=0;u<n.length;u++)for(c=1;c<n[u].length+1;c++)t.push(n[u].substring(0,c));return s={title:M,titleAsArray:t,newObj:void 0===q?null===P||void 0===P?void 0:P.newObj:(0,o.Z)(q,Object)&&0===Object.keys(q).length?"":q,userEmail:null===ee||void 0===ee?void 0:ee.email,userName:null===ee||void 0===ee?void 0:ee.displayName,userUid:null===ee||void 0===ee?void 0:ee.uid,category:ie||"",createdAt:(0,k.Bt)()},[4,(0,k.PL)((0,k.IO)((0,k.hJ)(y.db,"draftsBlogData"),(0,k.ar)("title","==",M)))];case 1:return(d=l.sent())>0?(f=d.docs[0].ref,[4,(0,k.r7)(f,s)]):[3,3];case 2:return l.sent(),O({position:"top",title:"Your draft has been updated",status:"success",duration:5e3,isClosable:!0}),[3,7];case 3:return(null===P||void 0===P?void 0:P.id)?(h=(0,k.JU)(y.db,"draftsBlogData",P.id),[4,(0,k.r7)(h,(0,i.Z)((0,a.Z)({},s),{createdAt:(0,k.Bt)()}))]):[3,5];case 4:return l.sent(),O({position:"top",title:"Your draft has been updated",status:"success",duration:5e3,isClosable:!0}),[3,7];case 5:return[4,(0,k.ET)((0,k.hJ)(y.db,"draftsBlogData"),s)];case 6:l.sent(),O({position:"top",title:"Your draft has been sucessfully saved",status:"success",duration:5e3,isClosable:!0}),l.label=7;case 7:return[3,9];case 8:return b=l.sent(),console.error("Error adding document: ",b),[3,9];case 9:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),xe=function(){var e=(0,r.Z)((function(e){var n;return(0,l.__generator)(this,(function(r){switch(r.label){case 0:return[4,(0,k.QT)(t)];case 1:return n=r.sent(),Promise.all([(0,k.oe)((0,k.JU)(y.db,"draftsBlogData",e)),(0,k.pl)(t,{count:n.data().count>0?n.data().count+1:0})]),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),we=[[{header:[1,2,3,4,5,6,!1]},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{color:["red","black","blue"]},{background:["red","black","blue","White"]}],["link","image","video","code-block","formula"],["clean"]],ke=function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=(0,r.Z)((function(){var t;return(0,l.__generator)(this,(function(n){return t=e.files[0],(new FormData).append("image",t),[2,new Promise((function(e,n){var r=(0,j.cF)(),o="".concat(t.name),a=(0,j.iH)(r,"blogImages/"+o),i=(0,j.B0)(a,t);i.on("state_changed",(function(e){oe(!0);e.state}),(function(e){n(e)}),(function(){(0,j.Jt)(i.snapshot.ref).then((function(t){e(t);var n=T.current.getEditor();n.deleteText(n.getSelection().index,1),n.insertEmbed(n.getSelection().index,"image",t),oe(!1)}))}))}))]}))}))},ye=(0,s.useMemo)((function(){return{blotFormatter:{},toolbar:{container:we,handlers:{image:ke}},clipboard:{matchVisual:!1}}}),[]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(C,{}),ee?(0,c.jsx)(p.xu,{bg:"#fff",display:"flex",justifyContent:"center",py:"28",px:"10",color:"black",children:(0,c.jsxs)(p.kC,{px:"2",py:"20",direction:"column",children:[(0,c.jsx)(p.xu,{pb:"4",children:(0,c.jsx)(g.Ph,{onChange:function(e){ue(e.target.value),se(!0)},placeholder:"Select Category",errorBorderColor:"red",focusBorderColor:"yellow.100",width:["100%","100%","50%","50%","50%"],required:!0,_placeholder:{color:"black",fontWeight:"400"},children:fe.reverse().map((function(e,t){return"all"!==e.key?"active"==e.status?(0,c.jsx)("option",{selected:(null===P||void 0===P?void 0:P.category)===e.id,value:e.id,children:e.name},e.key):"":null}))})}),(0,c.jsx)(p.xu,{w:"100%",mt:"6",children:(0,c.jsx)(v.g,{type:"text",color:"black",textTransform:"capitalize",placeholder:"Title",onChange:function(e){V(e.target.value),se(!0)},value:M||(null===P||void 0===P?void 0:P.title),border:"none",fontSize:"20px",h:"50px",fontWeight:"800",resize:"none",_focus:{colorScheme:"dark",border:"none",outline:"none",boxShadow:"none"},_hover:{border:"none",outline:"none"},_placeholder:{color:"black",fontWeight:"400",fontSize:"1xl"},sx:{"::-webkit-scrollbar":{display:"none"}}})}),(0,c.jsxs)(p.xu,{width:["80vw","80vw","50vw","50vw","50vw"],mb:"4",children:[N&&(0,c.jsx)(_,{forwardedRef:T,theme:"bubble",color:"white",placeholder:"Write something awesome...",modules:ye,value:q||(null===P||void 0===P?void 0:P.newObj),onChange:function(e,t,n,r){G(e),R(["[".concat(n,"] text-change")].concat((0,u.Z)(W))),D(!0),se(!0)},onChangeSelection:function(e,t){var n,r,o,a,i,l;null===T||void 0===T||null===(n=T.current)||void 0===n||null===(r=n.editor)||void 0===r||null===(o=r.theme)||void 0===o||null===(a=o.tooltip)||void 0===a||null===(i=a.root)||void 0===i||null===(l=i.classList)||void 0===l||l.remove("ql-hidden"),H(!!e),R(["[".concat(t,"] selection-change(").concat(pe(Y)," -> ").concat(pe(e),")")].concat((0,u.Z)(W)))},onFocus:function(e,t){var n,r,o,a,i,u;null===T||void 0===T||null===(n=T.current)||void 0===n||null===(r=n.editor)||void 0===r||null===(o=r.theme)||void 0===o||null===(a=o.tooltip)||void 0===a||null===(i=a.root)||void 0===i||null===(u=i.classList)||void 0===u||u.remove("ql-hidden"),G(q),R(["[".concat(t,"] focus(").concat(pe(e),")")].concat(W))},onBlur:function(e,t){R(["[".concat(t,"] blur(").concat(pe(e),")")].concat(W))}}),re&&(0,c.jsx)(m.Od,{height:"248px",width:"440px"})]}),(0,c.jsx)(p.kC,{mt:"20",justifyContent:"space-between",direction:"row",children:""===q||""===M||re||!ie?null:(0,c.jsx)(S,{onClickHandler:ge,disabledButton:""===q||""===M||re||!ie,text:"Publish",sizes:"md"})})]})}):(0,c.jsxs)(p.xu,{p:"40",bg:"#ffff",textAlign:"center",color:"black",children:[(0,c.jsx)(p.xv,{fontWeight:"600",fontSize:"2xl",children:"user not Found "}),(0,c.jsx)(S,{text:"Signin",onClickHandler:function(){B()}}),(0,c.jsx)(Z,{isOpen:f,onClose:A,onOpen:B})]}),(0,c.jsx)(E,{})]})}}},function(e){e.O(0,[2016,4597,2937,8646,1759,3238,542,5048,2894,9774,2888,179],(function(){return t=1744,e(e.s=t);var t}));var t=e.O();_N_E=t}]);