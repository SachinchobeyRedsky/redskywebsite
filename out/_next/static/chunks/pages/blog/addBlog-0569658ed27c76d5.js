(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6239],{68918:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/blog/addBlog",function(){return n(95592)}])},82583:function(e,t,n){"use strict";n.d(t,{db:function(){return c},I:function(){return l}});var r=n(83977),o=n(39828),a=n(91259),i=n(77004),u=(0,r.ZF)({apiKey:"AIzaSyBJA3OU9j2hD3eCcuBK1ufK9KIs7xkijqM",authDomain:"redsky-web.firebaseapp.com",projectId:"redsky-web",storageBucket:"redsky-web.appspot.com",messagingSenderId:"503303012281",appId:"1:503303012281:web:fbadea13c15e03b9c48068",measurementId:"G-75QR2Q2EBR"}),c=(0,o.ad)(u),l=(0,a.v0)(u);(0,i.$C)(u)},95592:function(e,t,n){"use strict";n.r(t);var r=n(34051),o=n.n(r),a=n(85893),i=n(67294),u=n(5152),c=n(97375),l=n(43238),s=n(68527),d=n(11391),f=n(33441),b=n(70553),p=(n(99624),n(91259)),h=n(11163),v=n(39828),m=n(82583),g=n(86650);n(5526);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,o,a,i){try{var u=e[a](i),c=u.value}catch(l){return void n(l)}u.done?t(c):Promise.resolve(c).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){w(a,r,o,i,u,"next",e)}function u(e){w(a,r,o,i,u,"throw",e)}i(void 0)}))}}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){k(e,t,n[t])}))}return e}function S(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=(0,u.default)((function(){return n.e(8302).then(n.bind(n,38302))}),{loadableGenerated:{webpack:function(){return[38302]}},ssr:!1}),O=(0,u.default)((function(){return Promise.all([n.e(9351),n.e(134)]).then(n.bind(n,87503))}),{loadableGenerated:{webpack:function(){return[87503]}}}),E=(0,u.default)((function(){return Promise.all([n.e(9351),n.e(7311),n.e(9876),n.e(2199),n.e(180)]).then(n.bind(n,80180))}),{loadableGenerated:{webpack:function(){return[80180]}}}),A=(0,u.default)((function(){return Promise.all([n.e(9351),n.e(3513),n.e(6893),n.e(2141),n.e(2919)]).then(n.bind(n,92141))}),{loadableGenerated:{webpack:function(){return[92141]}}}),B=(0,u.default)((function(){return Promise.all([n.e(4617),n.e(9351),n.e(7311),n.e(9839),n.e(8446)]).then(n.bind(n,68446))}),{loadableGenerated:{webpack:function(){return[68446]}}});(0,u.default)((function(){return Promise.all([n.e(9351),n.e(3993)]).then(n.bind(n,93993))}),{loadableGenerated:{webpack:function(){return[93993]}}});t.default=function(){var e=(0,v.JU)(m.db,"blogSettings","blogs-counter"),t=(0,v.JU)(m.db,"blogSettings","drafts-counter"),r=(0,c.qY)(),u=r.isOpen,x=r.onOpen,w=r.onClose,k=(0,l.pm)(),P=(0,i.useRef)(null),_=(0,p.v0)(),T=(0,h.useRouter)(),I=null===T||void 0===T?void 0:T.query,F=(0,i.useState)(!1),J=(F[0],F[1]),U=(0,i.useState)(!1),D=U[0],N=U[1],Q=(0,i.useState)(""),z=Q[0],q=Q[1],G=(0,i.useState)([]),L=G[0],W=G[1],R=(0,i.useState)(""),K=R[0],Y=R[1],H=(0,i.useState)(""),M=H[0],X=H[1],$=(0,i.useState)(""),V=$[0],Z=$[1],ee=(0,i.useState)(!1),te=ee[0],ne=ee[1],re=(0,i.useState)(""),oe=re[0],ae=re[1],ie=(0,i.useState)(!1),ue=ie[0],ce=ie[1],le=(0,i.useState)([]),se=le[0],de=le[1];(0,i.useEffect)((function(){q(I.newObj),X(I.title),ae(I.category)}),[]);var fe=function(){var e=y(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=y(o().mark((function e(t,r){var a,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(71167).Quill;case 2:return a=e.sent,e.next=5,n.e(3721).then(n.bind(n,3721));case 5:i=e.sent.default,(u=a.import("formats/image")).DEFAULTS=j({},u.DEFAULTS,{align:"center"}),t({Quill:a,BlotFormatter:i});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()).then((function(e){var t=e.Quill,n=e.BlotFormatter;t.register("modules/blotFormatter",n),console.log("bllofggggg>>>>",t.register("modules/blotFormatter",n))})).then((function(e){q(e),N(!0)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){fe()}),[]);var be=function(e){return e?[e.index,e.index+e.length].join(","):"none"};(0,i.useEffect)((function(){_.onAuthStateChanged(function(){var e=y(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return n=(0,v.JU)(m.db,"authUsers",t.uid),e.next=4,(0,v.QT)(n);case 4:(r=e.sent).exists()&&r.data().isBlocked?Z(null):Z(t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),(0,i.useEffect)((function(){var e=(0,v.IO)((0,v.hJ)(m.db,"categories"),(0,v.Xo)("createdAt","desc"));return(0,v.cf)(e,(function(e){var t=e.docs.map((function(e){return j({},e.data(),{id:e.id})}));de(t)}))}),[]);var pe=function(){var t=y(o().mark((function t(n){var r,a,i,u,c,l,s,d,f,b,p,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n.preventDefault(),t.prev=1,r=M.toLowerCase(),a=[],i=r.split(" "),u=1;u<M.length+1;u++)a.push(M.substring(0,u));for(c=0;c<i.length;c++)for(l=1;l<i[c].length+1;l++)a.push(i[c].substring(0,l));return t.next=9,(0,v.QT)(e);case 9:return s=t.sent,d=(0,v.hJ)(m.db,"categories"),f=(0,v.JU)(d,oe),t.next=14,(0,v.QT)(f);case 14:b=t.sent,p=b.data().count,h={title:M,titleAsArray:a,newObj:z,userEmail:V.email,userName:V.displayName,userUid:V.uid,category:b.data().key,createdAt:(0,v.Bt)()},Promise.all([(0,v.ET)((0,v.hJ)(m.db,"blogData"),j({},h)),(0,v.pl)(e,j({},s.data(),{all:{count:s.data().all.count+1,name:"All"}})),(0,v.pl)(f,j({},b.data(),{count:p+1}))]).then((function(){I.id&&me(I.id),T.push("/blog")})).catch((function(e){console.log(e)})),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(1),console.error("Error adding document: ",t.t0);case 23:case"end":return t.stop()}}),t,null,[[1,20]])})));return function(e){return t.apply(this,arguments)}}(),he=function(e){ue&&(ve(),ce(!1))};(0,i.useEffect)((function(){return T.events.on("routeChangeStart",he),function(){T.events.off("routeChangeStart",he)}}),[T.events,z,oe,M]),(0,i.useEffect)((function(){var e=setTimeout((function(){J(!0),ve()}),1e4);return function(){clearTimeout(e)}}),[z,oe,M]);var ve=function(){var e=y(o().mark((function e(){var t,n,r,a,i,u,c,l,s,d;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,t=M.toLowerCase(),n=[],r=t.split(" "),a=1;a<M.length+1;a++)n.push(M.substring(0,a));for(i=0;i<r.length;i++)for(u=1;u<r[i].length+1;u++)n.push(r[i].substring(0,u));return c={title:M,titleAsArray:n,newObj:void 0===z?null===I||void 0===I?void 0:I.newObj:(o=z,f=Object,(null!=f&&"undefined"!==typeof Symbol&&f[Symbol.hasInstance]?f[Symbol.hasInstance](o):o instanceof f)&&0===Object.keys(z).length?"":z),userEmail:null===V||void 0===V?void 0:V.email,userName:null===V||void 0===V?void 0:V.displayName,userUid:null===V||void 0===V?void 0:V.uid,category:oe||"",createdAt:(0,v.Bt)()},e.next=9,(0,v.PL)((0,v.IO)((0,v.hJ)(m.db,"draftsBlogData"),(0,v.ar)("title","==",M)));case 9:if(!((l=e.sent)>0)){e.next=17;break}return s=l.docs[0].ref,e.next=14,(0,v.r7)(s,c);case 14:k({position:"top",title:"Your draft has been updated",status:"success",duration:5e3,isClosable:!0}),e.next=28;break;case 17:if(!(null===I||void 0===I?void 0:I.id)){e.next=24;break}return d=(0,v.JU)(m.db,"draftsBlogData",I.id),e.next=21,(0,v.r7)(d,j({},c,{createdAt:(0,v.Bt)()}));case 21:k({position:"top",title:"Your draft has been updated",status:"success",duration:5e3,isClosable:!0}),e.next=28;break;case 24:return e.next=26,(0,v.ET)((0,v.hJ)(m.db,"draftsBlogData"),c);case 26:e.sent,k({position:"top",title:"Your draft has been sucessfully saved",status:"success",duration:5e3,isClosable:!0});case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(0),console.error("Error adding document: ",e.t0);case 33:case"end":return e.stop()}var o,f}),e,null,[[0,30]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=y(o().mark((function e(n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.QT)(t);case 2:r=e.sent,Promise.all([(0,v.oe)((0,v.JU)(m.db,"draftsBlogData",n)),(0,v.pl)(t,{count:r.data().count>0?r.data().count+1:0})]);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ge=[[{header:[1,2,3,4,5,6,!1]},{font:[]}],[{size:[]}],["bold","italic","underline","strike","blockquote"],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{color:["red","black","blue"]},{background:["red","black","blue","White"]}],["link","image","video","code-block","formula"],["clean"]],xe=function(){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/*"),e.click(),e.onchange=y(o().mark((function t(){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.files[0],(new FormData).append("image",n),t.abrupt("return",new Promise((function(e,t){var r=(0,g.cF)(),o="".concat(n.name),a=(0,g.iH)(r,"blogImages/"+o),i=(0,g.B0)(a,n);i.on("state_changed",(function(e){ne(!0);e.state}),(function(e){t(e)}),(function(){(0,g.Jt)(i.snapshot.ref).then((function(t){e(t);var n=P.current.getEditor();n.deleteText(n.getSelection().index,1),n.insertEmbed(n.getSelection().index,"image",t),ne(!1)}))}))})));case 4:case"end":return t.stop()}}),t)})))},we=(0,i.useMemo)((function(){return{blotFormatter:{},toolbar:{container:ge,handlers:{image:xe}},clipboard:{matchVisual:!1}}}),[]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E,{}),V?(0,a.jsx)(s.xu,{bg:"#fff",display:"flex",justifyContent:"center",py:"28",px:"10",color:"black",children:(0,a.jsxs)(s.kC,{px:"2",py:"20",direction:"column",children:[(0,a.jsx)(s.xu,{pb:"4",children:(0,a.jsx)(d.Ph,{onChange:function(e){ae(e.target.value),ce(!0)},placeholder:"Select Category",errorBorderColor:"red",focusBorderColor:"yellow.100",width:["100%","100%","50%","50%","50%"],required:!0,_placeholder:{color:"black",fontWeight:"400"},children:se.reverse().map((function(e,t){return"all"!==e.key?"active"==e.status?(0,a.jsx)("option",{selected:(null===I||void 0===I?void 0:I.category)===e.id,value:e.id,children:e.name},e.key):"":null}))})}),(0,a.jsx)(s.xu,{w:"100%",mt:"6",children:(0,a.jsx)(f.g,{type:"text",color:"black",textTransform:"capitalize",placeholder:"Title",onChange:function(e){X(e.target.value),ce(!0)},value:M||(null===I||void 0===I?void 0:I.title),border:"none",fontSize:"20px",h:"50px",fontWeight:"800",resize:"none",_focus:{colorScheme:"dark",border:"none",outline:"none",boxShadow:"none"},_hover:{border:"none",outline:"none"},_placeholder:{color:"black",fontWeight:"400",fontSize:"1xl"},sx:{"::-webkit-scrollbar":{display:"none"}}})}),(0,a.jsxs)(s.xu,{width:["80vw","80vw","50vw","50vw","50vw"],mb:"4",children:[D&&(0,a.jsx)(C,{forwardedRef:P,theme:"bubble",color:"white",placeholder:"Write something awesome...",modules:we,value:z||(null===I||void 0===I?void 0:I.newObj),onChange:function(e,t,n,r){q(e),W(["[".concat(n,"] text-change")].concat(S(L))),J(!0),ce(!0)},onChangeSelection:function(e,t){var n,r,o,a,i,u;null===P||void 0===P||null===(n=P.current)||void 0===n||null===(r=n.editor)||void 0===r||null===(o=r.theme)||void 0===o||null===(a=o.tooltip)||void 0===a||null===(i=a.root)||void 0===i||null===(u=i.classList)||void 0===u||u.remove("ql-hidden"),Y(!!e),W(["[".concat(t,"] selection-change(").concat(be(K)," -> ").concat(be(e),")")].concat(S(L)))},onFocus:function(e,t){var n,r,o,a,i,u;null===P||void 0===P||null===(n=P.current)||void 0===n||null===(r=n.editor)||void 0===r||null===(o=r.theme)||void 0===o||null===(a=o.tooltip)||void 0===a||null===(i=a.root)||void 0===i||null===(u=i.classList)||void 0===u||u.remove("ql-hidden"),q(z),W(["[".concat(t,"] focus(").concat(be(e),")")].concat(L))},onBlur:function(e,t){W(["[".concat(t,"] blur(").concat(be(e),")")].concat(L))}}),te&&(0,a.jsx)(b.Od,{height:"248px",width:"440px"})]}),(0,a.jsx)(s.kC,{mt:"20",justifyContent:"space-between",direction:"row",children:""===z||""===M||te||!oe?null:(0,a.jsx)(O,{onClickHandler:pe,disabledButton:""===z||""===M||te||!oe,text:"Publish",sizes:"md"})})]})}):(0,a.jsxs)(s.xu,{p:"40",bg:"#ffff",textAlign:"center",color:"black",children:[(0,a.jsx)(s.xv,{fontWeight:"600",fontSize:"2xl",children:"user not Found "}),(0,a.jsx)(O,{text:"Signin",onClickHandler:function(){x()}}),(0,a.jsx)(B,{isOpen:u,onClose:w,onOpen:x})]}),(0,a.jsx)(A,{})]})}}},function(e){e.O(0,[2016,4597,2937,9351,4607,3238,7163,5291,916,9774,2888,179],(function(){return t=68918,e(e.s=t);var t}));var t=e.O();_N_E=t}]);